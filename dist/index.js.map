{"version":3,"file":"index.js","sources":["../src/promisifyMethod.ts","../src/webBridge.ts","../src/index.ts","../src/promisifyInvoke.ts","../src/promisifyStorage.ts","../src/version.ts"],"sourcesContent":["function createCounter() {\n  return {\n    current: 0,\n    next() {\n      return ++this.current;\n    },\n  };\n}\n\nfunction createRequestResolver() {\n  type PromiseController = {\n    resolve: (value: any) => any;\n    reject: (reason: any) => any;\n  };\n\n  const counter = createCounter();\n  const promiseControllers: Record<string, PromiseController | null> = {};\n\n  return {\n    add(controller: PromiseController, customId?: number | string): number | string {\n      const id = customId != null ? customId : counter.next();\n      const methodId = id;\n      promiseControllers[methodId] = controller;\n      return methodId;\n    },\n\n    resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n      const requestPromise = promiseControllers[reqId];\n\n      if (requestPromise) {\n        if (isSuccess(error)) {\n          requestPromise.resolve(data);\n        } else {\n          requestPromise.reject(error);\n        }\n\n        promiseControllers[reqId] = null;\n      }\n    },\n  };\n}\n\nfunction promisifyMethod(method, subscribe: (fn: any) => void) {\n  const requestResolver = createRequestResolver();\n\n  subscribe((event) => {\n    if (!event.detail) {\n      return;\n    }\n\n    if ('reqId' in event.detail) {\n      const { reqId, data, error } = event.detail;\n\n      if (reqId) {\n        requestResolver.resolve(reqId, data, (error) => !(error), error);\n      }\n    }\n  });\n\n  return function promisifiedFunc(...args: any[]): Promise<any | void> {\n    return new Promise((resolve, reject) => {\n      const reqId = requestResolver.add({ resolve, reject });\n\n      method(reqId, ...args);\n    });\n  };\n}\n\nexport default promisifyMethod;\n","import type { AituBridge } from './index';\n\nconst AITU_DOMAIN_PARAM = '__aitu-domain'\n\nconst searchParams = new URLSearchParams(window.location.search)\n\nconst aituOrigin = searchParams.get(AITU_DOMAIN_PARAM)\n\ninterface WebBridge {\n    execute(method: keyof AituBridge, reqId: string, ...args: any[] ): void\n    origin: string\n}\n\nlet WebBridge: WebBridge | null = null\n\nif (aituOrigin) {\n    WebBridge = {\n        origin: aituOrigin,\n        execute: (method, reqId, ...args) => {\n            window.top.postMessage({\n                    source: 'aitu-bridge',\n                    method,\n                    reqId,\n                    payload: args,\n                },\n                WebBridge.origin\n            )\n    }\n\n    }\n\n    window.addEventListener('message', event => {\n        if (event.origin === aituOrigin && event.data) {\n            window.dispatchEvent(new CustomEvent('aituEvents', { detail: event.data }));\n        }\n    })\n}\n\nexport default WebBridge\n","import { LIB_VERSION } from './version';\n\nimport promisifyInvoke from './promisifyInvoke';\nimport promisifyStorage from './promisifyStorage';\nimport promisifyMethod from './promisifyMethod';\n\nimport WebBridge from './webBridge';\n\nenum EInvokeRequest {\n  getMe = 'GetMe',\n  getPhone = 'GetPhone',\n  getContacts = 'GetContacts',\n  getUserProfile = 'GetUserProfile',\n  enableNotifications = 'AllowNotifications',\n  disableNotifications = 'DisableNotifications'\n}\n\ntype SetItemType = (keyName: string, keyValue: string) => Promise<void>;\ntype GetItemType = (keyName: string) => Promise<string | null>;\ntype ClearType = () => Promise<void>;\n\ntype HeaderMenuItemClickHandlerType = (id: string) => Promise<void>;\ntype BackArrowClickHandlerType = () => Promise<void>;\n\ninterface GetPhoneResponse {\n  phone: string;\n  sign: string;\n}\n\ninterface GetMeResponse {\n  name: string;\n  lastname: string;\n  id: string;\n  avatar?: string;\n  avatarThumb?: string;\n  sign: string;\n}\n\ninterface ResponseObject {\n  phone?: string;\n  name?: string;\n  lastname?: string;\n}\n\ninterface GetGeoResponse {\n  latitude: number;\n  longitude: number;\n}\n\ninterface GetContactsResponse {\n  contacts: Array<{\n    first_name: string;\n    last_name: string;\n    phone: string;\n  }>;\n  sign: string;\n}\n\ninterface SelectContactResponse {\n  phone: string;\n  name: string;\n  lastname: string;\n}\n\ninterface GetUserProfileResponse {\n  name: string;\n  lastname?: string;\n  phone?: string;\n  avatar?: string;\n  avatarThumb?: string;\n}\n\nconst MAX_HEADER_MENU_ITEMS_COUNT = 3;\n\nexport enum HeaderMenuIcon {\n  Search = \"Search\",\n  ShoppingCart = \"ShoppingCart\",\n  Menu = \"Menu\",\n  Share = \"Share\",\n  Notifications = \"Notifications\",\n  Help = \"Help\",\n  Error = \"Error\",\n  Person = \"Person\",\n  Sort = \"Sort\",\n  Filter = \"Filter\"\n}\n\ninterface HeaderMenuItem {\n  id: string;\n  icon: HeaderMenuIcon;\n  badge?: string;\n}\n\ntype OpenSettingsResponse = 'success' | 'failed';\ntype ShareResponse = 'success' | 'failed';\ntype CopyToClipboardResponse = 'success' | 'failed';\ntype VibrateResponse = 'success' | 'failed';\n// todo: remove duplicates\ntype ResponseType = 'success' | 'failed';\n\ntype BridgeInvoke<T extends EInvokeRequest, R> = (method: T, data?: {}) => Promise<R>;\n\ninterface BridgeStorage {\n  setItem: SetItemType,\n  getItem: GetItemType,\n  clear: ClearType\n}\n\nexport interface AituBridge {\n  version: string;\n  invoke: BridgeInvoke<EInvokeRequest, ResponseObject>;\n  storage: BridgeStorage;\n  getMe: () => Promise<GetMeResponse>;\n  getPhone: () => Promise<GetPhoneResponse>;\n  getContacts: () => Promise<GetContactsResponse>;\n  getGeo: () => Promise<GetGeoResponse>;\n  selectContact: () => Promise<SelectContactResponse>;\n  getQr: () => Promise<string>;\n  getSMSCode: () => Promise<string>;\n  getUserProfile: (userId: string) => Promise<GetUserProfileResponse>;\n  share: (text: string) => Promise<ShareResponse>;\n  setTitle: (text: string) => Promise<ResponseType>;\n  copyToClipboard: (text: string) => Promise<CopyToClipboardResponse>;\n  shareImage: (text: string, image: string) => Promise<ShareResponse>;\n  shareFile: (text: string, filename: string, base64Data: string) => Promise<ShareResponse>;\n  enableNotifications: () => Promise<{}>;\n  disableNotifications: () => Promise<{}>;\n  openSettings: () => Promise<OpenSettingsResponse>;\n  closeApplication: () => Promise<ResponseType>;\n  setShakeHandler: (handler: any) => void;\n  setTabActiveHandler: (handler: (tabname: string) => void) => void;\n  vibrate: (pattern: number[]) => Promise<VibratePattern>;\n  isSupported: () => boolean;\n  supports: (method: string) => boolean;\n  sub: any;\n  enableScreenCapture: () => Promise<{}>;\n  disableScreenCapture: () => Promise<{}>;\n  setHeaderMenuItems: (items: Array<HeaderMenuItem>) => Promise<ResponseType>;\n  setHeaderMenuItemClickHandler: (handler: HeaderMenuItemClickHandlerType) => void;\n  setCustomBackArrowMode: (enabled: boolean) => Promise<ResponseType>;\n  getCustomBackArrowMode: () => Promise<boolean>;\n  setCustomBackArrowVisible: (visible: boolean) => Promise<ResponseType>;\n  setCustomBackArrowOnClickHandler: (handler: BackArrowClickHandlerType) => void;\n}\n\nconst invokeMethod = 'invoke';\nconst storageMethod = 'storage';\nconst getGeoMethod = 'getGeo';\nconst getQrMethod = 'getQr';\nconst getSMSCodeMethod = 'getSMSCode';\nconst selectContactMethod = 'selectContact';\nconst openSettingsMethod = 'openSettings';\nconst closeApplicationMethod = 'closeApplication';\nconst shareMethod = 'share';\nconst setTitleMethod = 'setTitle';\nconst copyToClipboardMethod = 'copyToClipboard';\nconst shareImageMethod = 'shareImage';\nconst shareFileMethod = 'shareFile';\nconst setShakeHandlerMethod = 'setShakeHandler';\nconst vibrateMethod = 'vibrate';\nconst enableScreenCaptureMethod = 'enableScreenCapture';\nconst disableScreenCaptureMethod = 'disableScreenCapture';\nconst setTabActiveHandlerMethod = 'setTabActiveHandler';\nconst setHeaderMenuItemsMethod = 'setHeaderMenuItems';\nconst setHeaderMenuItemClickHandlerMethod = 'setHeaderMenuItemClickHandler';\nconst setCustomBackArrowModeMethod = 'setCustomBackArrowMode';\nconst getCustomBackArrowModeMethod = 'getCustomBackArrowMode';\nconst setCustomBackArrowVisibleMethod = 'setCustomBackArrowVisible';\nconst setCustomBackArrowOnClickHandlerMethod = 'setCustomBackArrowOnClickHandler';\n\nconst android = typeof window !== 'undefined' && (window as any).AndroidBridge;\nconst ios = typeof window !== 'undefined' && (window as any).webkit && (window as any).webkit.messageHandlers;\nconst web = typeof window !== 'undefined' && (window.top !== window) && WebBridge;\n\nconst buildBridge = (): AituBridge => {\n  const subs = [];\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('aituEvents', (e: any) => {\n      [...subs].map((fn) => fn.call(null, e));\n    })\n  }\n\n  const invoke = (reqId, method, data = {}) => {\n    const isAndroid = android && android[invokeMethod];\n    const isIos = ios && ios[invokeMethod];\n\n    if (isAndroid) {\n      android[invokeMethod](reqId, method, JSON.stringify(data));\n    } else if (isIos) {\n      ios[invokeMethod].postMessage({ reqId, method, data });\n    } else if (web) {\n      web.execute(invokeMethod, reqId, data)\n    } else if (typeof window !== 'undefined') {\n      console.log('--invoke-isUnknown');\n    }\n  };\n\n  const storage = (reqId, method, data = {}) => {\n    const isAndroid = android && android[storageMethod];\n    const isIos = ios && ios[storageMethod];\n\n    if (isAndroid) {\n      android[storageMethod](reqId, method, JSON.stringify(data));\n    } else if (isIos) {\n      ios[storageMethod].postMessage({ reqId, method, data });\n    } else if (web) {\n      web.execute(storageMethod, reqId, { method, data });\n    } else if (typeof window !== 'undefined') {\n      console.log('--storage-isUnknown');\n    }\n  }\n\n  const getGeo = (reqId) => {\n    const isAndroid = android && android[getGeoMethod];\n    const isIos = ios && ios[getGeoMethod];\n\n    if (isAndroid) {\n      android[getGeoMethod](reqId);\n    } else if (isIos) {\n      ios[getGeoMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(getGeoMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--getGeo-isUnknown');\n    }\n  }\n\n  const getQr = (reqId) => {\n    const isAndroid = android && android[getQrMethod];\n    const isIos = ios && ios[getQrMethod];\n\n    if (isAndroid) {\n      android[getQrMethod](reqId);\n    } else if (isIos) {\n      ios[getQrMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(getQrMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--getQr-isUnknown');\n    }\n  }\n\n  const getSMSCode = (reqId) => {\n    const isAndroid = android && android[getSMSCodeMethod];\n    const isIos = ios && ios[getSMSCodeMethod];\n\n    if (isAndroid) {\n      android[getSMSCodeMethod](reqId);\n    } else if (isIos) {\n      ios[getSMSCodeMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(getSMSCodeMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--getSMSCode-isUnknown');\n    }\n  }\n\n  const selectContact = (reqId) => {\n    const isAndroid = android && android[selectContactMethod];\n    const isIos = ios && ios[selectContactMethod];\n\n    if (isAndroid) {\n      android[selectContactMethod](reqId);\n    } else if (isIos) {\n      ios[selectContactMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(selectContactMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--selectContact-isUnknown');\n    }\n  }\n\n  const openSettings = (reqId) => {\n    const isAndroid = android && android[openSettingsMethod];\n    const isIos = ios && ios[openSettingsMethod];\n\n    if (isAndroid) {\n      android[openSettingsMethod](reqId);\n    } else if (isIos) {\n      ios[openSettingsMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(openSettingsMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--openSettings-isUnknown');\n    }\n  }\n\n  const closeApplication = (reqId) => {\n    const isAndroid = android && android[closeApplicationMethod];\n    const isIos = ios && ios[closeApplicationMethod];\n\n    if (isAndroid) {\n      android[closeApplicationMethod](reqId);\n    } else if (isIos) {\n      ios[closeApplicationMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(closeApplicationMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--closeApplication-isUnknown');\n    }\n  }\n\n  const share = (reqId, text) => {\n    const isAndroid = android && android[shareMethod];\n    const isIos = ios && ios[shareMethod];\n\n    if (isAndroid) {\n      android[shareMethod](reqId, text);\n    } else if (isIos) {\n      ios[shareMethod].postMessage({ reqId, text });\n    } else if (web) {\n      web.execute(shareMethod, reqId, { text });\n    } else if (typeof window !== 'undefined') {\n      console.log('--share-isUnknown');\n    }\n  }\n\n  const setTitle = (reqId, text) => {\n    const isAndroid = android && android[setTitleMethod];\n    const isIos = ios && ios[setTitleMethod];\n\n    if (isAndroid) {\n      android[setTitleMethod](reqId, text);\n    } else if (isIos) {\n      ios[setTitleMethod].postMessage({ reqId, text });\n    } else if (web) {\n      web.execute(setTitleMethod, reqId, { text });\n    } else if (typeof window !== 'undefined') {\n      console.log('--setTitle-isUnknown');\n    }\n  }\n\n  const copyToClipboard = (reqId, text) => {\n    const isAndroid = android && android[copyToClipboardMethod];\n    const isIos = ios && ios[copyToClipboardMethod];\n\n    if (isAndroid) {\n      android[copyToClipboardMethod](reqId, text);\n    } else if (isIos) {\n      ios[copyToClipboardMethod].postMessage({ reqId, text });\n    } else if (web) {\n      web.execute(copyToClipboardMethod, reqId, { text });\n    } else if (typeof window !== 'undefined') {\n      console.log('--copyToClipboard-isUnknown');\n    }\n  }\n\n  const enableScreenCapture = (reqId) => {\n    const isAndroid = android && android[enableScreenCaptureMethod];\n    const isIos = ios && ios[enableScreenCaptureMethod];\n\n    if (isAndroid) {\n      android[enableScreenCaptureMethod](reqId);\n    } else if (isIos) {\n      ios[enableScreenCaptureMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(enableScreenCaptureMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--enableScreenCapture-isUnknown');\n    }\n  }\n\n  const disableScreenCapture = (reqId) => {\n    const isAndroid = android && android[disableScreenCaptureMethod];\n    const isIos = ios && ios[disableScreenCaptureMethod];\n\n    if (isAndroid) {\n      android[disableScreenCaptureMethod](reqId);\n    } else if (isIos) {\n      ios[disableScreenCaptureMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(disableScreenCaptureMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--disableScreenCapture-isUnknown');\n    }\n  }\n\n  const shareImage = (reqId, text, image) => {\n    // !!!======================!!!\n    // !!!===== Deprecated =====!!!\n    // !!!======================!!!\n\n    // const isAndroid = android && android[shareImageMethod];\n    // const isIos = ios && ios[shareImageMethod];\n\n    // if (isAndroid) {\n    //   android[shareImageMethod](reqId, text, image);\n    // } else if (isIos) {\n    //   ios[shareImageMethod].postMessage({ reqId, text, image });\n    // } else if (typeof window !== 'undefined') {\n    //   console.log('--shareImage-isWeb');\n    // }\n\n    // new one - fallback to shareFile\n    const isAndroid = android && android[shareFileMethod];\n    const isIos = ios && ios[shareFileMethod];\n\n    // get extension from base64 mime type and merge with name\n    const ext = image.split(';')[0].split('/')[1];\n    const filename = 'image.' + ext;\n    // remove mime type\n    const base64Data = image.substr(image.indexOf(',') + 1);\n\n    if (isAndroid) {\n      android[shareFileMethod](reqId, text, filename, base64Data);\n    } else if (isIos) {\n      ios[shareFileMethod].postMessage({ reqId, text, filename, base64Data });\n    } else if (web) {\n      web.execute(shareFileMethod, reqId, { text, filename, base64Data });\n    } else if (typeof window !== 'undefined') {\n      console.log('--shareFile-isUnknown');\n    }\n  }\n\n  const shareFile = (reqId, text, filename, base64Data) => {\n    const isAndroid = android && android[shareFileMethod];\n    const isIos = ios && ios[shareFileMethod];\n\n    if (isAndroid) {\n      android[shareFileMethod](reqId, text, filename, base64Data);\n    } else if (isIos) {\n      ios[shareFileMethod].postMessage({ reqId, text, filename, base64Data });\n    } else if (web) {\n      web.execute(shareFileMethod, reqId, { text, filename, base64Data });\n    } else if (typeof window !== 'undefined') {\n      console.log('--shareFile-isUnknown');\n    }\n  }\n\n  const enableNotifications = () => invokePromise(EInvokeRequest.enableNotifications);\n\n  const disableNotifications = () => invokePromise(EInvokeRequest.disableNotifications);\n\n  const setShakeHandler = (handler) => {\n    const isAndroid = android && android[setShakeHandlerMethod];\n    const isIos = ios && ios[setShakeHandlerMethod];\n\n    if (isAndroid || isIos || web) {\n      (window as any).onAituBridgeShake = handler;\n    } else if (typeof window !== 'undefined') {\n      console.log('--setShakeHandler-isUnknown');\n    }\n  };\n\n  const setTabActiveHandler = (handler: (tabname: string) => void) => {\n    const isAndroid = android && android[setTabActiveHandlerMethod];\n    const isIos = ios && ios[setTabActiveHandlerMethod];\n\n    if (isAndroid || isIos || web) {\n      (window as any).onAituBridgeTabActive = handler;\n    } else if (typeof window !== 'undefined') {\n      console.log('--setTabActiveHandler-isUnknown');\n    }\n  };\n\n  const vibrate = (reqId, pattern) => {\n    if (\n      !Array.isArray(pattern) ||\n      pattern.some((timing) => timing < 1 || timing !== Math.floor(timing)) ||\n      pattern.reduce((total, timing) => total + timing) > 10000\n    ) {\n      console.error('Pattern should be an array of positive integers no longer than 10000ms total');\n      return;\n    }\n\n    const isAndroid = android && android[vibrateMethod];\n    const isIos = ios && ios[vibrateMethod];\n\n    if (isAndroid) {\n      android[vibrateMethod](reqId, JSON.stringify(pattern));\n    } else if (isIos) {\n      ios[vibrateMethod].postMessage({ reqId, pattern });\n    }  else if (web) {\n      web.execute(vibrateMethod, reqId, { pattern });\n    } else if (typeof window !== 'undefined') {\n      console.log('--vibrate-isUnknown');\n    }\n  }\n\n  const isSupported = () => {\n    const iosSup = ios && (window as any).webkit.messageHandlers.invoke;\n    return Boolean(android || iosSup || web);\n  }\n\n  // TODO: implement web support\n  const supports = (method) =>\n    (android && typeof android[method] === 'function') ||\n    (ios && ios[method] && typeof ios[method].postMessage === 'function') ||\n    (web && typeof web[method] === 'function');\n\n  const sub = (listener: any) => {\n    subs.push(listener);\n  }\n\n  const setHeaderMenuItems = (reqId, items: Array<HeaderMenuItem>) => {\n    if (items.length > MAX_HEADER_MENU_ITEMS_COUNT) {\n      console.error('SetHeaderMenuItems: items count should not be more than ' + MAX_HEADER_MENU_ITEMS_COUNT);\n      return;\n    }\n\n    const isAndroid = android && android[setHeaderMenuItemsMethod];\n    const isIos = ios && ios[setHeaderMenuItemsMethod];\n\n    const itemsJsonArray = JSON.stringify(items);\n\n    if (isAndroid) {\n      android[setHeaderMenuItemsMethod](reqId, itemsJsonArray);\n    } else if (isIos) {\n      ios[setHeaderMenuItemsMethod].postMessage({ reqId, itemsJsonArray });\n    } else if (web) {\n      web.execute(setHeaderMenuItemsMethod, reqId, { itemsJsonArray });\n    } else if (typeof window !== 'undefined') {\n      console.log('--setHeaderMenuItems-isUnknown');\n    }\n  }\n\n  const setHeaderMenuItemClickHandler = (handler: HeaderMenuItemClickHandlerType) => {\n    const isAndroid = android && android[setHeaderMenuItemClickHandlerMethod];\n    const isIos = ios && ios[setHeaderMenuItemClickHandlerMethod];\n\n    if (isAndroid || isIos || web) {\n      (window as any).onAituBridgeHeaderMenuItemClick = handler;\n    } else if (typeof window !== 'undefined') {\n      console.log('--setHeaderMenuItemClickHandler-isUnknown');\n    }\n  }\n\n  const setCustomBackArrowMode = (reqId, enabled: boolean) => {\n    const isAndroid = android && android[setCustomBackArrowModeMethod];\n    const isIos = ios && ios[setCustomBackArrowModeMethod];\n\n    if (isAndroid) {\n      android[setCustomBackArrowModeMethod](reqId, enabled);\n    } else if (isIos) {\n      ios[setCustomBackArrowModeMethod].postMessage({ reqId, enabled });\n    } else if (web) {\n      web.execute(setCustomBackArrowModeMethod, reqId, { enabled });\n    } else if (typeof window !== 'undefined') {\n      console.log('--setCustomBackArrowMode-isUnknown');\n    }\n  }\n\n  const getCustomBackArrowMode = (reqId) => {\n    const isAndroid = android && android[getCustomBackArrowModeMethod];\n    const isIos = ios && ios[getCustomBackArrowModeMethod];\n\n    if (isAndroid) {\n      android[getCustomBackArrowModeMethod](reqId);\n    } else if (isIos) {\n      ios[getCustomBackArrowModeMethod].postMessage({ reqId });\n    } else if (web) {\n      web.execute(getCustomBackArrowModeMethod, reqId);\n    } else if (typeof window !== 'undefined') {\n      console.log('--getCustomBackArrowMode-isUnknown');\n    }\n  }\n\n  const setCustomBackArrowVisible = (reqId, visible: boolean) => {\n    const isAndroid = android && android[setCustomBackArrowVisibleMethod];\n    const isIos = ios && ios[setCustomBackArrowVisibleMethod];\n\n    if (isAndroid) {\n      android[setCustomBackArrowVisibleMethod](reqId, visible);\n    } else if (isIos) {\n      ios[setCustomBackArrowVisibleMethod].postMessage({ reqId, visible });\n    } else if (web) {\n      web.execute(setCustomBackArrowVisibleMethod, reqId, { visible });\n    } else if (typeof window !== 'undefined') {\n      console.log('--setCustomBackArrowVisible-isUnknown');\n    }\n  }\n\n  const setCustomBackArrowOnClickHandler = (handler: BackArrowClickHandlerType) => {\n    const isAndroid = android && android[setCustomBackArrowOnClickHandlerMethod];\n    const isIos = ios && ios[setCustomBackArrowOnClickHandlerMethod];\n\n    if (isAndroid || isIos || web) {\n      (window as any).onAituBridgeBackArrowClick = handler;\n    } else if (typeof window !== 'undefined') {\n      console.log('--setCustomBackArrowOnClickHandler-isUnknown');\n    }\n  }\n\n  const invokePromise = promisifyInvoke(invoke, sub);\n  const storagePromise = promisifyStorage(storage, sub);\n  const getGeoPromise = promisifyMethod(getGeo, sub);\n  const getQrPromise = promisifyMethod(getQr, sub);\n  const getSMSCodePromise = promisifyMethod(getSMSCode, sub);\n  const selectContactPromise = promisifyMethod(selectContact, sub);\n  const openSettingsPromise = promisifyMethod(openSettings, sub);\n  const closeApplicationPromise = promisifyMethod(closeApplication, sub);\n  const sharePromise = promisifyMethod(share, sub);\n  const setTitlePromise = promisifyMethod(setTitle, sub);\n  const copyToClipboardPromise = promisifyMethod(copyToClipboard, sub);\n  const shareImagePromise = promisifyMethod(shareImage, sub);\n  const shareFilePromise = promisifyMethod(shareFile, sub);\n  const vibratePromise = promisifyMethod(vibrate, sub);\n  const enableScreenCapturePromise = promisifyMethod(enableScreenCapture, sub);\n  const disableScreenCapturePromise = promisifyMethod(disableScreenCapture, sub);\n  const setHeaderMenuItemsPromise = promisifyMethod(setHeaderMenuItems, sub);\n  const setCustomBackArrowModePromise = promisifyMethod(setCustomBackArrowMode, sub);\n  const getCustomBackArrowModePromise = promisifyMethod(getCustomBackArrowMode, sub);\n  const setCustomBackArrowVisiblePromise = promisifyMethod(setCustomBackArrowVisible, sub);\n\n  return {\n    version: String(LIB_VERSION),\n    copyToClipboard: copyToClipboardPromise,\n    invoke: invokePromise,\n    storage: storagePromise,\n    getMe: () => invokePromise(EInvokeRequest.getMe),\n    getPhone: () => invokePromise(EInvokeRequest.getPhone),\n    getContacts: () => invokePromise(EInvokeRequest.getContacts),\n    getGeo: getGeoPromise,\n    getQr: getQrPromise,\n    getSMSCode: getSMSCodePromise,\n    getUserProfile: (id: string) => invokePromise(EInvokeRequest.getUserProfile, { id }),\n    selectContact: selectContactPromise,\n    enableNotifications,\n    disableNotifications,\n    openSettings: openSettingsPromise,\n    closeApplication: closeApplicationPromise,\n    setTitle: setTitlePromise,\n    share: sharePromise,\n    shareImage: shareImagePromise,\n    shareFile: shareFilePromise,\n    setShakeHandler,\n    setTabActiveHandler,\n    vibrate: vibratePromise,\n    isSupported,\n    supports,\n    sub,\n    enableScreenCapture: enableScreenCapturePromise,\n    disableScreenCapture: disableScreenCapturePromise,\n    setHeaderMenuItems: setHeaderMenuItemsPromise,\n    setHeaderMenuItemClickHandler,\n    setCustomBackArrowMode: setCustomBackArrowModePromise,\n    getCustomBackArrowMode: getCustomBackArrowModePromise,\n    setCustomBackArrowVisible: setCustomBackArrowVisiblePromise,\n    setCustomBackArrowOnClickHandler,\n  }\n}\n\nconst bridge = buildBridge();\n\nexport default bridge;\n","function createCounter() {\n  return {\n    current: 0,\n    next() {\n      return ++this.current;\n    },\n  };\n}\n\nfunction createRequestResolver() {\n  type PromiseController = {\n    resolve: (value: any) => any;\n    reject: (reason: any) => any;\n  };\n\n  const counter = createCounter();\n  const promiseControllers: Record<string, PromiseController | null> = {};\n\n  return {\n    add(controller: PromiseController, customId?: number | string): number | string {\n      const id = customId != null ? customId : counter.next();\n      const invokeId = id;\n      promiseControllers[invokeId] = controller;\n      return invokeId;\n    },\n\n    resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n      const requestPromise = promiseControllers[reqId];\n\n      if (requestPromise) {\n        if (isSuccess(error)) {\n          requestPromise.resolve(data);\n        } else {\n          requestPromise.reject(error);\n        }\n\n        promiseControllers[reqId] = null;\n      }\n    },\n  };\n}\n\nfunction promisifyInvoke(invoke, subscribe: (fn: any) => void) {\n  const requestResolver = createRequestResolver();\n\n  subscribe((event) => {\n    if (!event.detail) {\n      return;\n    }\n\n    if ('reqId' in event.detail) {\n      const { reqId, data, error } = event.detail;\n\n      if (reqId) {\n        requestResolver.resolve(reqId, data, (error) => !(error), error);\n      }\n    }\n  });\n\n  return function promisifiedFunc(method: any, props: any = {}): Promise<any | void> {\n    return new Promise((resolve, reject) => {\n      const reqId = requestResolver.add({ resolve, reject }, props.reqId);\n\n      invoke(reqId, method, props);\n    });\n  };\n}\n\nexport default promisifyInvoke;\n","function createCounter() {\n    return {\n      current: 0,\n      next() {\n        return ++this.current;\n      },\n    };\n  }\n  \n  function createRequestResolver() {\n    type PromiseController = {\n      resolve: (value: any) => any;\n      reject: (reason: any) => any;\n    };\n  \n    const counter = createCounter();\n    const promiseControllers: Record<string, PromiseController | null> = {};\n  \n    return {\n      add(controller: PromiseController, customId?: number | string): number | string {\n        const id = customId != null ? customId : counter.next();\n        const storageId = `s${id}`;\n        promiseControllers[storageId] = controller;\n        return storageId;\n      },\n  \n      resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n        const requestPromise = promiseControllers[reqId];\n  \n        if (requestPromise) {\n          if (isSuccess(error)) {\n            requestPromise.resolve(data);\n          } else {\n            requestPromise.reject(error);\n          }\n  \n          promiseControllers[reqId] = null;\n        }\n      },\n    };\n  }\n  \n  function promisifyStorage(storage, subscribe: (fn: any) => void) {\n    const requestResolver = createRequestResolver();\n  \n    subscribe((event) => {\n      if (!event.detail) {\n        return;\n      }\n  \n      if ('reqId' in event.detail) {\n        const { reqId, data, error } = event.detail;\n  \n        if (reqId) {\n          requestResolver.resolve(reqId, data, (error) => !(error), error);\n        }\n      }\n    });\n\n    return {\n      setItem: (keyName: string, keyValue: string): Promise<void> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'setItem', { keyName, keyValue });\n        });\n      },\n      getItem: (keyName: string): Promise<string | null> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'getItem', { keyName });\n        });\n      },\n      clear: (): Promise<void> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'clear', {});\n        });\n      },\n    }\n  }\n  \n  export default promisifyStorage;\n  ","export const LIB_VERSION = \"0.2.20\";\n"],"names":["promisifyMethod","method","subscribe","counter","promiseControllers","requestResolver","current","next","this","add","controller","customId","methodId","resolve","reqId","data","isSuccess","error","requestPromise","reject","event","detail","Promise","aituOrigin","URLSearchParams","window","location","search","get","WebBridge","origin","execute","top","postMessage","source","payload","addEventListener","dispatchEvent","CustomEvent","EInvokeRequest","HeaderMenuIcon","android","AndroidBridge","ios","webkit","messageHandlers","web","bridge","subs","e","map","fn","call","sub","listener","push","invokePromise","invokeId","props","isIos","JSON","stringify","console","log","invoke","storagePromise","storage","storageId","setItem","keyName","keyValue","getItem","clear","promisifyStorage","getGeoPromise","getQrPromise","getSMSCodePromise","selectContactPromise","openSettingsPromise","closeApplicationPromise","sharePromise","text","setTitlePromise","copyToClipboardPromise","shareImagePromise","image","isAndroid","filename","split","base64Data","substr","indexOf","shareFilePromise","vibratePromise","pattern","Array","isArray","some","timing","Math","floor","reduce","total","enableScreenCapturePromise","disableScreenCapturePromise","setHeaderMenuItemsPromise","items","length","itemsJsonArray","setCustomBackArrowModePromise","enabled","getCustomBackArrowModePromise","setCustomBackArrowVisiblePromise","visible","version","String","copyToClipboard","getMe","getPhone","getContacts","getGeo","getQr","getSMSCode","getUserProfile","id","selectContact","enableNotifications","disableNotifications","openSettings","closeApplication","setTitle","share","shareImage","shareFile","setShakeHandler","handler","onAituBridgeShake","setTabActiveHandler","onAituBridgeTabActive","vibrate","isSupported","iosSup","Boolean","supports","enableScreenCapture","disableScreenCapture","setHeaderMenuItems","setHeaderMenuItemClickHandler","onAituBridgeHeaderMenuItemClick","setCustomBackArrowMode","getCustomBackArrowMode","setCustomBackArrowVisible","setCustomBackArrowOnClickHandler","onAituBridgeBackArrowClick","buildBridge"],"mappings":"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"}